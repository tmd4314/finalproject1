import{d as M,a as z,n as m,c as O,o as R,p as A,i as d,j as l,w as n,g as c,v as q,h as D,m as p,t as _,b as P,_ as $}from"./index-DTBJ0DMA.js";const F={class:"equipment-management-page"},G={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},H={class:"flex justify-end gap-2 mt-4"},J={class:"flex justify-between items-center mb-4"},K={class:"va-h5"},Q={class:"flex gap-2"},W={class:"text-sm"},X=M({__name:"EquipmentManagement",setup(Y){var C;const v=z();console.log("âœ… auth_type ê°’ì€:",(C=v.user)==null?void 0:C.auth_type);const S=P(),f=m([]),u=m([]),o=m({equipmentCode:"",equipmentName:"",category:"",status:""}),y=m([]),b=m([]),w=[{key:"eq_id",label:"ì„¤ë¹„ ë²ˆí˜¸",sortable:!0},{key:"eq_name",label:"ì„¤ë¹„ëª…",sortable:!0},{key:"eq_group_name",label:"ë¶„ë¥˜",sortable:!0},{key:"location",label:"ìœ„ì¹˜",sortable:!0},{key:"eq_run_name",label:"ì„¤ë¹„ìƒíƒœ",sortable:!0}],V=O(()=>f.value.filter(t=>{const e=!o.value.equipmentCode||t.eq_id.toLowerCase().includes(o.value.equipmentCode.toLowerCase()),s=!o.value.equipmentName||t.eq_name.toLowerCase().includes(o.value.equipmentName.toLowerCase()),r=!o.value.category||t.eq_group_code===o.value.category,i=!o.value.status||t.eq_run_code===o.value.status;return e&&s&&r&&i})),N=async()=>{o.value={equipmentCode:"",equipmentName:"",category:"",status:""},u.value=[],await g()},E=async()=>{var e;if(((e=v.user)==null?void 0:e.department_code)!=="04"){alert("ì„¤ë¹„íŒ€ë§Œ ìˆ˜ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.");return}if(u.value.length!==1){alert("ìˆ˜ì •í•  ì„¤ë¹„ 1ê°œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}const t=u.value[0].eq_id;console.log("ðŸ”— ìˆ˜ì • ë²„íŠ¼ í´ë¦­. ì´ë™í•  ID:",t),S.push({path:"/faq/equipment-register",query:{mode:"edit",eq_id:t}})},B=async()=>{var s;if(((s=v.user)==null?void 0:s.department_code)!=="04"){alert("ì„¤ë¹„íŒ€ë§Œ ì‚­ì œí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.");return}if(u.value.length===0){alert("ì‚­ì œí•  ì„¤ë¹„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");return}if(!confirm(`${u.value.length}ê°œ ì„¤ë¹„ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`))return;const e=u.value.map(r=>r.eq_id);try{await q.post("/equipments/delete",{eq_ids:e}),alert("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),await g(),u.value=[]}catch(r){console.error(r),alert("ì‚­ì œ ì‹¤íŒ¨")}},L=async()=>{const t=await q.get("/common-codes?groups=0E,0S");y.value=t.data["0E"]||[],b.value=t.data["0S"]||[]},g=async()=>{const t=await q.get("/equipments");t.data.isSuccessed&&(f.value=t.data.data.map(e=>{var s;return{...e,eq_id:(s=e.eq_id)==null?void 0:s.toString()}}))},U=t=>({e1:"primary",e2:"success",e3:"warning"})[t]||"secondary",j=t=>({s1:"success",s2:"info",s3:"danger"})[t]||"secondary",I=t=>[t.factory_name,t.floor_name,t.room_name].filter(Boolean).join(" > ")||"-";return R(()=>{g(),L()}),(t,e)=>{const s=c("VaInput"),r=c("VaSelect"),i=c("VaButton"),h=c("VaCardContent"),x=c("VaCard"),k=c("VaChip"),T=c("VaDataTable");return D(),A("div",F,[e[9]||(e[9]=d("h1",{class:"va-h3 mb-6"},"ì„¤ë¹„ ê´€ë¦¬",-1)),l(x,{class:"mb-6"},{default:n(()=>[l(h,null,{default:n(()=>[e[6]||(e[6]=d("h2",{class:"va-h5 mb-4"},"ê²€ìƒ‰ ì¡°ê±´",-1)),d("div",G,[l(s,{modelValue:o.value.equipmentCode,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.equipmentCode=a),label:"ì„¤ë¹„ë²ˆí˜¸",placeholder:"ì„¤ë¹„ë²ˆí˜¸ ìž…ë ¥",clearable:""},null,8,["modelValue"]),l(s,{modelValue:o.value.equipmentName,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.equipmentName=a),label:"ì„¤ë¹„ëª…",placeholder:"ì„¤ë¹„ëª… ìž…ë ¥",clearable:""},null,8,["modelValue"]),l(r,{modelValue:o.value.category,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.category=a),label:"ì„¤ë¹„ë¶„ë¥˜",options:y.value,"text-by":"label","value-by":"value",clearable:"",placeholder:"ì „ì²´"},null,8,["modelValue","options"]),l(r,{modelValue:o.value.status,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.status=a),label:"ì„¤ë¹„ìƒíƒœ",options:b.value,"text-by":"label","value-by":"value",clearable:"",placeholder:"ì „ì²´"},null,8,["modelValue","options"])]),d("div",H,[l(i,{color:"secondary",onClick:N},{default:n(()=>e[5]||(e[5]=[p("ì´ˆê¸°í™”")])),_:1,__:[5]})])]),_:1,__:[6]})]),_:1}),l(x,null,{default:n(()=>[l(h,null,{default:n(()=>[d("div",J,[d("h2",K,"ì„¤ë¹„ ëª©ë¡ (ì´ "+_(V.value.length)+"ê°œ)",1),d("div",Q,[l(i,{color:"warning",onClick:E},{default:n(()=>e[7]||(e[7]=[p("ìˆ˜ì •")])),_:1,__:[7]}),l(i,{color:"danger",onClick:B},{default:n(()=>e[8]||(e[8]=[p("ì‚­ì œ")])),_:1,__:[8]})])]),l(T,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),items:V.value,columns:w,"item-key":"eq_id",selectable:"","select-mode":"multiple","sticky-header":"",hoverable:""},{"cell(eq_group_name)":n(({rowData:a})=>[l(k,{color:U(a.eq_group_code),size:"small",flat:""},{default:n(()=>[p(_(a.eq_group_name||a.eq_group_code),1)]),_:2},1032,["color"])]),"cell(location)":n(({rowData:a})=>[d("span",W,_(I(a)),1)]),"cell(eq_run_name)":n(({rowData:a})=>[l(k,{color:j(a.eq_run_code),size:"small",flat:""},{default:n(()=>[p(_(a.eq_run_name||a.eq_run_code),1)]),_:2},1032,["color"])]),_:1},8,["modelValue","items"])]),_:1})]),_:1})])}}}),ee=$(X,[["__scopeId","data-v-71b62624"]]);export{ee as default};
//# sourceMappingURL=EquipmentManagement-DPlt1yHs.js.map
