{"version":3,"file":"faultyInsertPage-DdiQqa5o.js","sources":["../../../client/src/pages/quality/faultyInsertPage.vue"],"sourcesContent":[" <template>\r\n  <div class=\"product-page\">\r\n    <div class=\"product-container\">\r\n      <div>\r\n        <!-- 제품 등록 폼 -->\r\n        <div class=\"product-form\">\r\n          <h3 class=\"form-title\">불량품검사 등록</h3>\r\n          <va-select\r\n            v-model=\"form.productCode\"\r\n            :options=\"productOptions\"\r\n            label=\"제품명\"\r\n            class=\"quarter-width\"\r\n            value-by=\"value\"\r\n            text-by=\"label\"\r\n            placeholder=\"제품을 선택하세요\"\r\n          />\r\n          <va-select\r\n            v-model=\"form.code\"\r\n            :options=\"workOrderOptions\"\r\n            label=\"작업지시서번호\"\r\n            class=\"quarter-width\"\r\n            value-by=\"value\"\r\n            text-by=\"label\"\r\n            placeholder=\"작업지시서를 선택하세요\"\r\n          />\r\n          <va-input v-model=\"form.processStage\" label=\"공정단계\" readonly />\r\n          <va-select\r\n            v-model=\"form.faultyType\"\r\n            :options=\"defectTypeOptions\"\r\n            label=\"불량유형\"\r\n            class=\"quarter-width\"\r\n            value-by=\"value\"\r\n            text-by=\"label\"\r\n            placeholder=\"불량유형 선택하세요\"\r\n          />\r\n\r\n          <!-- 불량상세 자동입력 -->\r\n          <va-input\r\n            v-model=\"form.faultyDetail\"\r\n            label=\"불량상세\"\r\n            readonly\r\n          />\r\n          <va-input v-model=\"form.faultyQuantity\" label=\"불량수량\" readonly />\r\n          <va-input v-model=\"form.occurDate\" label=\"불합판정일자\" type=\"date\" readonly/>\r\n          <va-input v-model=\"form.detail\" label=\"상세설명\" readonly/>\r\n\r\n          <div class=\"form-buttons\">\r\n            <va-button @click=\"registerProduct\" color=\"primary\">등록</va-button>\r\n            <va-button @click=\"resetForm\" color=\"secondary\">초기화</va-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { ref, onMounted, watch } from 'vue'\r\nimport axios from 'axios'\r\n\r\nconst form = ref({\r\n  productCode: '',\r\n  code: '',\r\n  processStage: '',\r\n  faultyType: '',\r\n  faultyDetail: '',\r\n  faultyQuantity: '',\r\n  occurDate: '',\r\n  detail: '',\r\n})\r\n\r\nconst productOptions = ref<{ label: string; value: string }[]>([])\r\nconst workOrderOptions = ref<{ label: string; value: string }[]>([])\r\n\r\nconst resetForm = () => {\r\n  form.value = {\r\n    productCode: '',\r\n    code: '',\r\n    processStage: '',\r\n    faultyType: '',\r\n    faultyDetail: '',\r\n    faultyQuantity: '',\r\n    occurDate: '',\r\n    detail: '',\r\n  }\r\n  workOrderOptions.value = [] // 제품명 변경 시 작업지시서도 초기화\r\n}\r\n\r\n// 제품명 목록 불러오기\r\nonMounted(async () => {\r\n  try {\r\n    const res = await axios.get('/faultys/productList')\r\n    productOptions.value = res.data.map((item: any) => ({\r\n      label: item.product_name,\r\n      value: item.product_code,\r\n    }))\r\n  } catch (err) {\r\n    console.error('제품명 목록 조회 실패:', err)\r\n  }\r\n})\r\n\r\n// ✅ 제품명이 선택되었을 때 작업지시서 목록 가져오기\r\nwatch(() => form.value.productCode, async (newCode) => {\r\n  if (!newCode) return\r\n  try {\r\n    const res = await axios.get('/faultys/faultyOrderNoList', {\r\n      params: { productCode: newCode }\r\n    })\r\n    workOrderOptions.value = res.data.map((item: any) => ({\r\n      label: item.work_order_no,\r\n      value: item.work_order_no,\r\n    }))\r\n  } catch (err) {\r\n    console.error('작업지시서 번호 조회 실패:', err)\r\n  }\r\n})\r\n\r\nwatch(() => form.value.code, async (newCode) => {\r\n  if (!newCode) return;\r\n\r\n  try {\r\n    const res = await axios.get('/faultys/faultyDetail', {\r\n      params: { workOrderNo: newCode }\r\n    });\r\n\r\n    if (res.data.length > 0) {\r\n      const detail = res.data[0];\r\n      form.value.processStage = detail.process_name || '';\r\n      form.value.faultyQuantity = detail.insp_value_qty || '';\r\n      form.value.occurDate = detail.created_at || '';\r\n      form.value.detail = detail.qual_remark || '';\r\n    }\r\n  } catch (err) {\r\n    console.error('불량 상세 정보 조회 실패:', err);\r\n  }\r\n});\r\n\r\nconst defectTypeOptions = ref<{ label: string; value: string; remark: string }[]>([]);\r\n\r\nonMounted(async () => {\r\n  try {\r\n    const res = await axios.get('/faultys/defectTypeList');\r\n    defectTypeOptions.value = res.data.map((item: any) => ({\r\n      label: item.defect_type_name,\r\n      value: item.defect_type_name,\r\n      remark: item.defect_type_remark\r\n    }));\r\n  } catch (err) {\r\n    console.error('불량유형 목록 조회 실패:', err);\r\n  }\r\n});\r\n\r\nwatch(() => form.value.faultyType, (selectedType) => {\r\n  const match = defectTypeOptions.value.find(item => item.value === selectedType);\r\n  form.value.faultyDetail = match ? match.remark : '';\r\n});\r\n\r\nconst registerProduct = async () => {\r\n  try {\r\n    const payload = {\r\n      product_code: form.value.productCode,\r\n      work_order_no: form.value.code,\r\n      process_name: form.value.processStage,\r\n      defect_type: form.value.faultyType,\r\n      defect_detail: form.value.faultyDetail,\r\n      quantity: Number(form.value.faultyQuantity),\r\n      occur_date: form.value.occurDate,\r\n      qual_remark: form.value.detail,\r\n    };\r\n\r\n    const res = await axios.post('/faultys/register', payload);\r\n\r\n    if (res.status === 200) {\r\n      alert('불량품검사 등록 성공');\r\n      resetForm();\r\n    } else {\r\n      alert('등록 실패');\r\n    }\r\n  } catch (err) {\r\n    console.error('등록 오류:', err);\r\n    alert('등록 중 오류가 발생했습니다.');\r\n  }\r\n};\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.product-page {\r\n  padding: 1.5rem;\r\n  display: flex;\r\n  justify-content: center;\r\n  height: 739px;\r\n}\r\n\r\n.product-container {\r\n  width: 1060px;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.product-form {\r\n  background-color: white;\r\n  border-radius: 0.5rem;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);\r\n  padding: 1rem;\r\n}\r\n\r\n.form-title {\r\n  font-size: 1.125rem;\r\n  font-weight: 600;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.va-input {\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.form-buttons {\r\n  display: flex;\r\n  justify-content: flex-end; /* 오른쪽 정렬 */\r\n  gap: 0.5rem;\r\n  margin-top: 0.5rem;\r\n}\r\n\r\n.judgment-radio-group {\r\n  display: flex;\r\n  justify-content: center; /* 가운데 정렬 */\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n</style>\r\n"],"names":["form","ref","productOptions","workOrderOptions","resetForm","onMounted","res","axios","item","err","watch","newCode","detail","defectTypeOptions","selectedType","match","registerProduct","payload","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_cache","_createVNode","_component_va_select","$event","_component_va_input","_hoisted_4","_component_va_button"],"mappings":"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"}