{"version":3,"file":"ProductSearchModal.vue_vue_type_script_setup_true_lang-C6pavVZ3.js","sources":["../../../client/src/pages/modals/ProductSearchModal.vue"],"sourcesContent":["<template>\r\n  <va-modal v-model=\"visible\" title=\"제품 검색\" size=\"large\">\r\n    <div class=\"va-mb-4 va-row va-gap-2\">\r\n      <va-input v-model=\"search.product_name\" label=\"제품명\" />\r\n      <va-input v-model=\"search.product_stand\" label=\"제품규격\" />\r\n      <va-input v-model=\"search.result_id\" label=\"실적ID\" />\r\n      <va-button @click=\"searchProducts\">검색</va-button>\r\n    </div>\r\n\r\n    <va-data-table :items=\"productList\" :columns=\"columns\" track-by=\"product_code\">\r\n      <template #cell(select)=\"{ row }\">\r\n        <va-checkbox\r\n          :model-value=\"row.rowData.selected\"\r\n          @update:modelValue=\"val => handleSelect(row.rowData, val)\"\r\n        />\r\n      </template>\r\n    </va-data-table>\r\n\r\n    <div class=\"va-mt-4 va-row va-justify-end va-gap-2\">\r\n      <va-button color=\"primary\" @click=\"applySelection\">선택</va-button>\r\n    </div>\r\n  </va-modal>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, defineProps, defineEmits } from 'vue'\r\nimport axios from 'axios'\r\n\r\nconst props = defineProps<{ visible: boolean }>()\r\nconst emit = defineEmits(['update:visible', 'apply'])\r\n\r\nconst visible = computed({\r\n  get: () => props.visible,\r\n  set: (val) => emit('update:visible', val)\r\n})\r\n\r\nconst search = ref({\r\n  product_name: '',\r\n  product_stand: '',\r\n  result_id: ''\r\n})\r\n\r\nconst productList = ref<any[]>([])\r\n\r\nconst columns = [\r\n  { key: 'select', label: '선택', width: 60 },\r\n  { key: 'work_order_no', label: '작업지시 코드' },\r\n  { key: 'product_name', label: '제품명' },\r\n  { key: 'product_stand', label: '제품규격' },\r\n  { key: 'result_id', label: '실적 ID' }\r\n]\r\n\r\nconst searchProducts = async () => {\r\n  try {\r\n    const res = await axios.get('/prodResult')\r\n    productList.value = res.data\r\n      .filter((item: any) => {\r\n        return (\r\n          (!search.value.product_name || item.product_name.includes(search.value.product_name)) &&\r\n          (!search.value.product_stand || item.product_stand.includes(search.value.product_stand))\r\n        )\r\n      })\r\n      .map((item: any) => ({ ...item, selected: false }))\r\n  } catch (err) {\r\n    alert('제품 목록 조회 실패')\r\n  }\r\n}\r\n\r\nconst handleSelect = (target: any, val: boolean) => {\r\n  productList.value.forEach(item => item.selected = false)\r\n  if (val) target.selected = true\r\n}\r\n\r\nconst applySelection = () => {\r\n  const selected = productList.value.find(p => p.selected)\r\n  if (selected) {\r\n    emit('apply', selected)\r\n    visible.value = false\r\n  } else {\r\n    alert('선택된 제품이 없습니다.')\r\n  }\r\n}\r\n</script>\r\n"],"names":["props","__props","emit","__emit","visible","computed","val","search","ref","productList","columns","searchProducts","res","axios","item","handleSelect","target","applySelection","selected","p","_createBlock","_component_va_modal","$event","_createElementVNode","_hoisted_1","_createVNode","_component_va_input","_cache","_component_va_button","_component_va_data_table","_withCtx","row","_component_va_checkbox","_hoisted_2"],"mappings":"yTA4BA,MAAMA,EAAQC,EACRC,EAAOC,EAEPC,EAAUC,EAAS,CACvB,IAAK,IAAML,EAAM,QACjB,IAAMM,GAAQJ,EAAK,iBAAkBI,CAAG,CAAA,CACzC,EAEKC,EAASC,EAAI,CACjB,aAAc,GACd,cAAe,GACf,UAAW,EAAA,CACZ,EAEKC,EAAcD,EAAW,EAAE,EAE3BE,EAAU,CACd,CAAE,IAAK,SAAU,MAAO,KAAM,MAAO,EAAA,EACrC,CAAE,IAAK,gBAAiB,MAAO,SAAA,EAC/B,CAAE,IAAK,eAAgB,MAAO,KAAA,EAC9B,CAAE,IAAK,gBAAiB,MAAO,MAAA,EAC/B,CAAE,IAAK,YAAa,MAAO,OAAA,CAAQ,EAG/BC,EAAiB,SAAY,CACjC,GAAI,CACF,MAAMC,EAAM,MAAMC,EAAM,IAAI,aAAa,EACzCJ,EAAY,MAAQG,EAAI,KACrB,OAAQE,IAEJ,CAACP,EAAO,MAAM,cAAgBO,EAAK,aAAa,SAASP,EAAO,MAAM,YAAY,KAClF,CAACA,EAAO,MAAM,eAAiBO,EAAK,cAAc,SAASP,EAAO,MAAM,aAAa,EAEzF,EACA,IAAKO,IAAe,CAAE,GAAGA,EAAM,SAAU,EAAA,EAAQ,CAAA,MACxC,CACZ,MAAM,aAAa,CAAA,CACrB,EAGIC,EAAe,CAACC,EAAaV,IAAiB,CAClDG,EAAY,MAAM,QAAQK,GAAQA,EAAK,SAAW,EAAK,EACnDR,MAAY,SAAW,GAAA,EAGvBW,EAAiB,IAAM,CAC3B,MAAMC,EAAWT,EAAY,MAAM,KAAKU,GAAKA,EAAE,QAAQ,EACnDD,GACFhB,EAAK,QAASgB,CAAQ,EACtBd,EAAQ,MAAQ,IAEhB,MAAM,eAAe,CACvB,0HA/EAgB,EAoBWC,EAAA,YApBQjB,EAAA,2CAAAA,EAAO,MAAAkB,GAAE,MAAM,QAAQ,KAAK,OAAA,aAC7C,IAKM,CALNC,EAKM,MALNC,EAKM,CAJJC,EAAsDC,EAAA,CAAnC,WAAAnB,EAAA,MAAO,aAAP,sBAAAoB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,GAAAf,EAAA,MAAO,aAAYe,GAAE,MAAM,KAAA,yBAC9CG,EAAwDC,EAAA,CAArC,WAAAnB,EAAA,MAAO,cAAP,sBAAAoB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,GAAAf,EAAA,MAAO,cAAae,GAAE,MAAM,MAAA,yBAC/CG,EAAoDC,EAAA,CAAjC,WAAAnB,EAAA,MAAO,UAAP,sBAAAoB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,GAAAf,EAAA,MAAO,UAASe,GAAE,MAAM,MAAA,yBAC3CG,EAAiDG,EAAA,CAArC,QAAOjB,GAAc,WAAE,IAAEgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,IAAE,CAAA,mBAGvCF,EAOgBI,EAAA,CAPA,MAAOpB,EAAA,MAAc,QAAAC,EAAkB,WAAS,cAAA,GACnD,eAAYoB,EACrB,CAGE,CAJuB,IAAAC,KAAG,CAC5BN,EAGEO,EAAA,CAFC,cAAaD,EAAI,QAAQ,SACzB,sBAAmBzB,GAAOS,EAAagB,EAAI,QAASzB,CAAG,CAAA,oEAK9DiB,EAEM,MAFNU,EAEM,CADJR,EAAiEG,EAAA,CAAtD,MAAM,UAAW,QAAOX,CAAA,aAAgB,IAAEU,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,IAAE,CAAA"}