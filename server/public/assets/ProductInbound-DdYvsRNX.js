import{_ as X,b as Y,c as U,n as g,o as Z,x as ee,p as d,i as e,z as N,D as b,E as y,J as T,m as C,t as s,G as B,q,F as P,y as A,v as S,f as l}from"./index-KTdWOH4t.js";const te={class:"max-w-[1060px] h-[739px] mx-auto p-4 bg-gray-50 overflow-hidden"},oe={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",style:{height:"calc(100% - 60px)"}},re={class:"flex border-b border-gray-200 mb-4"},se={key:0,class:"h-full"},de={class:"grid grid-cols-5 gap-3 mb-4"},le={class:"flex justify-between items-center mb-4"},ae={class:"flex items-center gap-3"},ne={class:"text-sm text-gray-600"},ue={class:"font-medium text-blue-600"},ie={class:"flex gap-2"},ce=["disabled"],pe={key:1,class:"text-sm text-orange-600 bg-orange-50 px-3 py-2 rounded border border-orange-200"},be={class:"flex-1 overflow-auto border border-gray-200 rounded mb-4",style:{height:"calc(100% - 200px)"}},xe={class:"w-full text-xs border-collapse bg-white"},ge={class:"bg-gray-50 sticky top-0"},ye={key:0,class:"border border-gray-200 px-2 py-2 text-center font-medium text-gray-700 w-12"},fe={key:0},me=["colspan"],ve={key:1},_e=["colspan"],he={key:0,class:"border border-gray-200 px-2 py-2 text-center"},we=["onUpdate:modelValue"],ke={class:"border border-gray-200 px-2 py-2 text-center"},Ce={class:"border border-gray-200 px-2 py-2 font-mono text-xs"},Ie={class:"border border-gray-200 px-2 py-2"},Le={class:"border border-gray-200 px-2 py-2"},Me={class:"border border-gray-200 px-2 py-2 text-center"},Ve={class:"border border-gray-200 px-2 py-2 text-center"},Ue={class:"flex justify-between items-center text-xs text-gray-600"},qe={key:1,class:"h-full"},Se={class:"grid grid-cols-5 gap-3 mb-4"},$e={class:"flex justify-between items-center mb-4"},je={class:"flex items-center gap-3"},Ee={class:"text-sm text-gray-600"},De={class:"font-medium text-green-600"},Ne={class:"flex-1 overflow-auto border border-gray-200 rounded mb-4",style:{height:"calc(100% - 200px)"}},Te={class:"w-full text-xs border-collapse bg-white"},Be={key:0},Pe={key:1},Ae={class:"border border-gray-200 px-2 py-2 text-center"},Fe={class:"border border-gray-200 px-2 py-2 text-center"},Oe={class:"border border-gray-200 px-2 py-2 font-mono text-xs"},We={class:"border border-gray-200 px-2 py-2"},ze={class:"border border-gray-200 px-2 py-2"},Ge={class:"border border-gray-200 px-2 py-2 text-center"},Je={class:"border border-gray-200 px-2 py-2 text-center"},Ke={class:"border border-gray-200 px-2 py-2 font-mono text-xs"},Re={class:"flex justify-between items-center text-xs text-gray-600"},He={__name:"ProductInbound",setup(Qe){const F=Y(),f=U(()=>F.canManageLogistics),x=g("waiting"),I=g(!1),L=g(!1),n=g([]),m=g([]),i=g({result_id:"",product_name:"",product_code:"",request_date:""}),c=g({lot_num:"",product_name:"",product_code:"",inbound_date:""}),v=g(!1),O=U(()=>n.value.some(r=>r.selected)),W=U(()=>n.value.filter(r=>r.selected).length),z=r=>r?r.split(" ")[0]:"-",$=r=>!r&&r!==0?"-":new Intl.NumberFormat("ko-KR").format(r),G=()=>{n.value.forEach(r=>{r.selected=v.value})},J=()=>{i.value={result_id:"",product_name:"",product_code:"",request_date:""},_()},K=()=>{c.value={lot_num:"",product_name:"",product_code:"",inbound_date:""},h()},_=async()=>{var r,t;I.value=!0;try{const o=await S.get("/productInbound/waiting-list",{params:i.value});n.value=o.data.map(u=>({...u,selected:!1,isProcessing:!1})),v.value=!1}catch(o){let u="입고 대기 목록을 불러오는데 실패했습니다.";(t=(r=o.response)==null?void 0:r.data)!=null&&t.error&&(u=o.response.data.error),alert(u),n.value=[]}finally{I.value=!1}},h=async()=>{var r,t;L.value=!0;try{const o=await S.get("/productInbound/completed-list",{params:c.value});m.value=o.data}catch(o){let u="입고 완료 목록을 불러오는데 실패했습니다.";(t=(r=o.response)==null?void 0:r.data)!=null&&t.error&&(u=o.response.data.error),alert(u),m.value=[]}finally{L.value=!1}},R=async()=>{var o,u;const r=n.value.filter(p=>p.selected);if(r.length===0){alert("입고 처리할 제품을 선택해주세요.");return}if(confirm(`선택된 ${r.length}건의 제품을 일괄 입고 처리하시겠습니까?`))try{r.forEach(a=>{a.isProcessing=!0});const p=r.map(a=>({result_id:a.result_id,product_code:a.product_code,inbound_qty:a.inbound_qty,manufacture_datetime:a.manufacture_datetime,work_order_no:a.work_order_no})),w=await S.post("/productInbound/process-multiple",{products:p}),{success_count:Q,error_count:j,results:M,errors:V}=w.data;M&&M.length>0&&M.forEach(a=>{const E=n.value.findIndex(D=>D.result_id===a.result_id&&D.product_code===a.product_code);E>-1&&n.value.splice(E,1)});let k=`일괄 입고 처리 완료
성공: ${Q}건`;j>0&&(k+=`
실패: ${j}건`,V&&V.length>0&&(k+=`

실패 상세:`,V.forEach(a=>{k+=`
- ${a.product_code}: ${a.error}`}))),alert(k),v.value=!1}catch(p){let w="일괄 입고 처리 중 오류가 발생했습니다.";(u=(o=p.response)==null?void 0:o.data)!=null&&u.error&&(w=p.response.data.error),alert(w)}finally{r.forEach(p=>{p.isProcessing=!1})}},H=()=>{x.value==="waiting"?_():x.value==="completed"&&h()};return Z(()=>{f.value||alert("조회만 가능합니다. 입고 처리 권한이 없습니다."),_()}),ee(x,H),(r,t)=>(l(),d("div",te,[t[33]||(t[33]=e("div",{class:"mb-3"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"제품 입고 관리")],-1)),e("div",oe,[e("div",re,[e("button",{onClick:t[0]||(t[0]=o=>x.value="waiting"),class:N(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",x.value==="waiting"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"])}," 입고 대기 목록 ",2),e("button",{onClick:t[1]||(t[1]=o=>x.value="completed"),class:N(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",x.value==="completed"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"])}," 입고 완료 목록 ",2)]),x.value==="waiting"?(l(),d("div",se,[e("div",de,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"작업실적ID",-1)),b(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>i.value.result_id=o),class:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"작업실적ID 검색"},null,512),[[y,i.value.result_id]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"제품명",-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>i.value.product_name=o),class:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"제품명 검색"},null,512),[[y,i.value.product_name]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"제품코드",-1)),b(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>i.value.product_code=o),class:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"제품코드 검색"},null,512),[[y,i.value.product_code]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"요청일자",-1)),b(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>i.value.request_date=o),type:"date",class:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500"},null,512),[[y,i.value.request_date]])]),e("div",{class:"flex items-end gap-2"},[e("button",{onClick:_,class:"px-4 py-1.5 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors"}," 검색 "),e("button",{onClick:J,class:"px-4 py-1.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors"}," 초기화 ")])]),e("div",le,[e("div",ae,[e("button",{onClick:_,class:"px-4 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors flex items-center gap-2"},t[15]||(t[15]=[T('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-675b64d9><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" data-v-675b64d9></path><path d="M21 3v5h-5" data-v-675b64d9></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" data-v-675b64d9></path><path d="M3 21v-5h5" data-v-675b64d9></path></svg> 새로고침 ',2)])),e("div",ne,[t[16]||(t[16]=C(" 입고 대기: ")),e("span",ue,s(n.value.length)+"건",1)])]),e("div",ie,[f.value?(l(),d("button",{key:0,onClick:R,disabled:!O.value,class:"px-4 py-2 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 입고 ("+s(W.value)+"건) ",9,ce)):(l(),d("div",pe," 조회 전용 (입고 권한 없음) "))])]),e("div",be,[e("table",xe,[e("thead",ge,[e("tr",null,[f.value?(l(),d("th",ye,[b(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=o=>v.value=o),onChange:G,class:"rounded"},null,544),[[B,v.value]])])):q("",!0),t[17]||(t[17]=e("th",{class:"border border-gray-200 px-2 py-2 text-center font-medium text-gray-700 w-24"},"요청일자",-1)),t[18]||(t[18]=e("th",{class:"border border-gray-200 px-2 py-2 text-left font-medium text-gray-700 w-24"},"제품코드",-1)),t[19]||(t[19]=e("th",{class:"border border-gray-200 px-2 py-2 text-left font-medium text-gray-700 w-32"},"제품명",-1)),t[20]||(t[20]=e("th",{class:"border border-gray-200 px-2 py-2 text-left font-medium text-gray-700 w-24"},"규격",-1)),t[21]||(t[21]=e("th",{class:"border border-gray-200 px-2 py-2 text-center font-medium text-gray-700 w-16"},"단위",-1)),t[22]||(t[22]=e("th",{class:"border border-gray-200 px-2 py-2 text-center font-medium text-gray-700 w-20"},"수량",-1))])]),e("tbody",null,[I.value?(l(),d("tr",fe,[e("td",{colspan:f.value?7:6,class:"text-center text-gray-500 py-8"},t[23]||(t[23]=[e("div",{class:"flex items-center justify-center gap-2"},[e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),C(" 데이터를 불러오는 중... ")],-1)]),8,me)])):n.value.length===0?(l(),d("tr",ve,[e("td",{colspan:f.value?7:6,class:"text-center text-gray-500 py-8"}," 입고 대기 중인 제품이 없습니다. ",8,_e)])):(l(!0),d(P,{key:2},A(n.value,(o,u)=>(l(),d("tr",{key:`${o.result_id}-${o.product_code}`,class:"hover:bg-gray-50"},[f.value?(l(),d("td",he,[b(e("input",{type:"checkbox","onUpdate:modelValue":p=>o.selected=p,class:"rounded"},null,8,we),[[B,o.selected]])])):q("",!0),e("td",ke,s(o.request_date),1),e("td",Ce,s(o.product_code),1),e("td",Ie,s(o.product_name),1),e("td",Le,s(o.product_stand||"-"),1),e("td",Me,s(o.product_unit||"-"),1),e("td",Ve,s($(o.inbound_qty)),1)]))),128))])])]),e("div",Ue,[e("div",null," 전체 "+s(n.value.length)+"건 ",1)])])):x.value==="completed"?(l(),d("div",qe,[e("div",Se,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"LOT번호",-1)),b(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>c.value.lot_num=o),class:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"LOT번호 검색"},null,512),[[y,c.value.lot_num]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"제품명",-1)),b(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>c.value.product_name=o),class:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"제품명 검색"},null,512),[[y,c.value.product_name]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"제품코드",-1)),b(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>c.value.product_code=o),class:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"제품코드 검색"},null,512),[[y,c.value.product_code]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"입고일자",-1)),b(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>c.value.inbound_date=o),type:"date",class:"w-full px-2 py-1.5 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500"},null,512),[[y,c.value.inbound_date]])]),e("div",{class:"flex items-end gap-2"},[e("button",{onClick:h,class:"px-4 py-1.5 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors"}," 검색 "),e("button",{onClick:K,class:"px-4 py-1.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors"}," 초기화 ")])]),e("div",$e,[e("div",je,[e("button",{onClick:h,class:"px-4 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors flex items-center gap-2"},t[28]||(t[28]=[T('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-675b64d9><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" data-v-675b64d9></path><path d="M21 3v5h-5" data-v-675b64d9></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" data-v-675b64d9></path><path d="M3 21v-5h5" data-v-675b64d9></path></svg> 새로고침 ',2)])),e("div",Ee,[t[29]||(t[29]=C(" 입고 완료: ")),e("span",De,s(m.value.length)+"건",1)])])]),e("div",Ne,[e("table",Te,[t[32]||(t[32]=e("thead",{class:"bg-gray-50 sticky top-0"},[e("tr",null,[e("th",{class:"border border-gray-200 px-2 py-2 text-center font-medium text-gray-700 w-24"},"입고일"),e("th",{class:"border border-gray-200 px-2 py-2 text-center font-medium text-gray-700 w-24"},"유통기한"),e("th",{class:"border border-gray-200 px-2 py-2 text-left font-medium text-gray-700 w-24"},"제품코드"),e("th",{class:"border border-gray-200 px-2 py-2 text-left font-medium text-gray-700 w-32"},"제품명"),e("th",{class:"border border-gray-200 px-2 py-2 text-left font-medium text-gray-700 w-24"},"규격"),e("th",{class:"border border-gray-200 px-2 py-2 text-center font-medium text-gray-700 w-16"},"단위"),e("th",{class:"border border-gray-200 px-2 py-2 text-center font-medium text-gray-700 w-20"},"수량"),e("th",{class:"border border-gray-200 px-2 py-2 text-left font-medium text-gray-700 w-32"},"완제품LOT")])],-1)),e("tbody",null,[L.value?(l(),d("tr",Be,t[30]||(t[30]=[e("td",{colspan:"8",class:"text-center text-gray-500 py-8"},[e("div",{class:"flex items-center justify-center gap-2"},[e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),C(" 데이터를 불러오는 중... ")])],-1)]))):m.value.length===0?(l(),d("tr",Pe,t[31]||(t[31]=[e("td",{colspan:"8",class:"text-center text-gray-500 py-8"}," 입고 완료된 제품이 없습니다. ",-1)]))):(l(!0),d(P,{key:2},A(m.value,(o,u)=>(l(),d("tr",{key:`${o.lot_num}`,class:"hover:bg-gray-50"},[e("td",Ae,s(z(o.inbound_date)),1),e("td",Fe,s(o.expiry_date),1),e("td",Oe,s(o.product_code),1),e("td",We,s(o.product_name),1),e("td",ze,s(o.product_stand||"-"),1),e("td",Ge,s(o.product_unit||"-"),1),e("td",Je,s($(o.quantity)),1),e("td",Ke,s(o.lot_num),1)]))),128))])])]),e("div",Re,[e("div",null," 전체 "+s(m.value.length)+"건 ",1)])])):q("",!0)])]))}},Ye=X(He,[["__scopeId","data-v-675b64d9"]]);export{Ye as default};
//# sourceMappingURL=ProductInbound-DdYvsRNX.js.map
