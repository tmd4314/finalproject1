import{d as $,n,c as A,o as R,e as V,f as k,p as C,i as r,j as u,w as i,q as j,v as g,m as y,_ as q}from"./index-KTdWOH4t.js";const E={class:"product-page"},L={class:"product-container"},M={class:"product-grid"},S={class:"product-table"},z={class:"product-filters"},G={class:"product-form"},H={class:"form-header"},J={key:0,class:"image-preview"},K=["src"],O={class:"form-buttons"},Q=$({__name:"ProductPage",setup(W){const b=n([]),m=async()=>{try{const o=await g.get("/product");b.value=o.data}catch(o){console.log("❌ 제품 목록 조회 실패:",o)}},U=[{key:"select",label:"선택"},{key:"product_code",label:"제품코드"},{key:"product_name",label:"제품명"},{key:"product_unit",label:"단위"},{key:"product_stand",label:"규격"}],d=n({product_code:"",product_name:"",product_stand:""}),w=n(1),P=A(()=>b.value.filter(o=>(!d.value.product_code||o.product_code.includes(d.value.product_code))&&(!d.value.product_name||o.product_name.includes(d.value.product_name))&&(!d.value.product_stand||o.product_stand.includes(d.value.product_stand)))),t=n({product_code:"",product_name:"",product_pay:"",product_atc:"",product_gred:"",product_stand:"",product_perdt:"",product_unit:"",product_safty:"",product_img:""}),_=n(null),c=n(null);function s(){t.value={product_code:"",product_name:"",product_pay:"",product_atc:"",product_gred:"",product_stand:"",product_perdt:"",product_unit:"",product_safty:"",product_img:""},_.value=null,c.value=null}function x(o){var v;const e=(v=o.target.files)==null?void 0:v[0];if(!e)return;c.value=e,t.value.product_img=e.name;const a=new FileReader;a.onload=()=>{_.value=a.result},a.readAsDataURL(e)}async function D(){if(!t.value.product_code||!t.value.product_name){alert("필수값 누락");return}const o=new FormData;for(const e in t.value)o.append(e,t.value[e]);c.value&&o.append("image",c.value);try{(await g.post("/product",o,{headers:{"Content-Type":"multipart/form-data"}})).data.isSuccessed==!0?(alert("등록완료!"),await m(),s()):alert("등록 실패!")}catch(e){console.log("오류 발생:",e),alert("서버 오류!")}}async function F(){const o=t.value.product_code.trim();if(!o){alert("제품코드가 없습니다. 수정할 수 없습니다.");return}const e=new FormData;for(const a in t.value)e.append(a,t.value[a]);c.value&&e.append("image",c.value);try{(await g.put(`/product/${o}`,e,{headers:{"Content-Type":"multipart/form-data"}})).data.isUpdated===!0?(alert("수정 완료!"),await m(),s()):alert("수정 실패!")}catch(a){console.error("❌ 수정 오류:",a),alert("서버 오류!")}}async function T(){const o=t.value.product_code.trim();if(!o){alert("제품코드가 없습니다. 삭제할 수 없습니다.");return}if(confirm(`정말로 ${o} 제품을 삭제하시겠습니까?`))try{(await g.delete(`/product/${o}`)).data.isDeleted==!0?(alert("삭제 완료!"),await m(),s()):alert("삭제 실패! (해당 제품이 존재하지 않거나 이미 삭제됨)")}catch(e){console.error("❌ 삭제 중 오류 발생:",e),alert("서버 오류!")}}const p=n(null);function N(o,e){o?(p.value=e.product_code,t.value={...e}):(p.value=null,s())}return R(()=>{m()}),(o,e)=>{const a=V("va-input"),v=V("va-checkbox"),B=V("va-data-table"),f=V("va-button");return k(),C("div",E,[r("div",L,[e[17]||(e[17]=r("h2",{class:"product-title"},"제품 관리",-1)),r("div",M,[r("div",S,[r("div",z,[u(a,{modelValue:d.value.product_code,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value.product_code=l),label:"제품코드",class:"filter-input"},null,8,["modelValue"]),u(a,{modelValue:d.value.product_name,"onUpdate:modelValue":e[1]||(e[1]=l=>d.value.product_name=l),label:"제품명",class:"filter-input"},null,8,["modelValue"]),u(a,{modelValue:d.value.product_stand,"onUpdate:modelValue":e[2]||(e[2]=l=>d.value.product_stand=l),label:"규격",class:"filter-spec-input"},null,8,["modelValue"])]),u(B,{items:P.value,columns:U,"per-page":10,"current-page":w.value,"track-by":"product_code"},{"cell(select)":i(({row:l})=>[u(v,{"model-value":p.value===l.source.product_code,"onUpdate:modelValue":I=>N(I,l.source),disabled:p.value!==null&&p.value!==l.source.product_code},null,8,["model-value","onUpdate:modelValue","disabled"])]),_:1},8,["items","current-page"])]),r("div",G,[r("div",H,[e[12]||(e[12]=r("h3",{class:"form-title"},"제품 등록",-1)),r("input",{type:"file",accept:"image/*",onChange:x},null,32)]),_.value?(k(),C("div",J,[r("img",{src:_.value,alt:"첨부 이미지 미리보기"},null,8,K)])):j("",!0),u(a,{modelValue:t.value.product_code,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.product_code=l),label:"제품코드"},null,8,["modelValue"]),u(a,{modelValue:t.value.product_name,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.product_name=l),label:"제품명"},null,8,["modelValue"]),u(a,{modelValue:t.value.product_pay,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.product_pay=l),label:"판매가"},null,8,["modelValue"]),u(a,{modelValue:t.value.product_atc,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.product_atc=l),label:"ATC코드"},null,8,["modelValue"]),u(a,{modelValue:t.value.product_gred,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.product_gred=l),label:"주요성분"},null,8,["modelValue"]),u(a,{modelValue:t.value.product_stand,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.product_stand=l),label:"규격"},null,8,["modelValue"]),u(a,{modelValue:t.value.product_perdt,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.product_perdt=l),label:"허가일",type:"date"},null,8,["modelValue"]),u(a,{modelValue:t.value.product_unit,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.product_unit=l),label:"단위"},null,8,["modelValue"]),u(a,{modelValue:t.value.product_safty,"onUpdate:modelValue":e[11]||(e[11]=l=>t.value.product_safty=l),label:"안전재고"},null,8,["modelValue"]),r("div",O,[u(f,{onClick:D,color:"primary"},{default:i(()=>e[13]||(e[13]=[y("등록")])),_:1,__:[13]}),u(f,{onClick:s,color:"secondary"},{default:i(()=>e[14]||(e[14]=[y("초기화")])),_:1,__:[14]}),u(f,{onClick:F,color:"warning"},{default:i(()=>e[15]||(e[15]=[y("수정")])),_:1,__:[15]}),u(f,{onClick:T,color:"danger"},{default:i(()=>e[16]||(e[16]=[y("삭제")])),_:1,__:[16]})])])])])])}}}),Y=q(Q,[["__scopeId","data-v-90ea2d0d"]]);export{Y as default};
//# sourceMappingURL=ProductPage-ARK58EYh.js.map
